<!DOCTYPE html>
<html lang="fr" dir="ltr" class="client-nojs">
<head>
<title>Curseurs d'objets (tech) - Wiki1000</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.18.6" />
<link rel="shortcut icon" href="https://frp.sage.fr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="Wiki1000 (fr)" />
<link rel="EditURI" type="application/rsd+xml" href="https://frp.sage.fr/wiki1000/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Flux Atom de Wiki1000" href="https://frp.sage.fr/wiki1000/index.php?title=Sp%C3%83%C2%A9cial:Modifications_r%C3%83%C2%A9centes&amp;feed=atom" />
<link rel="stylesheet" href="../load.php@debug=false&amp;lang=fr&amp;modules=mediawiki.legacy.commonPrint,shared%257Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;%252A.css" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/wiki1000/skins/monobook/IE50Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/wiki1000/skins/monobook/IE55Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/wiki1000/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki1000/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="../load.php@debug=false&amp;lang=fr&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;%252A.css" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: wiki1000dbtahoe-l1000_:resourceloader:filter:minify-css:4:c88e2bcd56513749bec09a7e29cb3ffa */
</style>
<script src="../load.php@debug=false&amp;lang=fr&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;%252A"></script>
<script>if(window.mw){
	mw.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "Curseurs_d\'objets_(tech)", "wgTitle": "Curseurs d\'objets (tech)", "wgCurRevisionId": 11197, "wgArticleId": 262, "wgIsArticle": true, "wgAction": "view", "wgUserName": null, "wgUserGroups": ["*"], "wgCategories": ["Objets techniques", "Objets itérateurs", "Curseur"], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script><script>if(window.mw){
	mw.loader.load(["mediawiki.page.startup"]);
}
</script>
<style type="text/css">/*<![CDATA[*/
.source-delphi {line-height: normal;}
.source-delphi li, .source-delphi pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for delphi
 * CSS class: source-delphi, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.delphi.source-delphi .de1, .delphi.source-delphi .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.delphi.source-delphi  {font-family:monospace;}
.delphi.source-delphi .imp {font-weight: bold; color: red;}
.delphi.source-delphi li, .delphi.source-delphi .li1 {font-weight: normal; vertical-align:top;}
.delphi.source-delphi .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.delphi.source-delphi .li2 {font-weight: bold; vertical-align:top;}
.delphi.source-delphi .kw1 {color: #000000; font-weight: bold;}
.delphi.source-delphi .kw2 {color: #000000; font-weight: bold;}
.delphi.source-delphi .kw3 {color: #000066;}
.delphi.source-delphi .kw4 {color: #000066; font-weight: bold;}
.delphi.source-delphi .co1 {color: #808080; font-style: italic;}
.delphi.source-delphi .co2 {color: #008000; font-style: italic;}
.delphi.source-delphi .coMULTI {color: #808080; font-style: italic;}
.delphi.source-delphi .es0 {color: #ff0000; font-weight: bold;}
.delphi.source-delphi .br0 {color: #000066;}
.delphi.source-delphi .sy0 {color: #000066;}
.delphi.source-delphi .sy1 {color: #000066;}
.delphi.source-delphi .sy2 {color: #000066;}
.delphi.source-delphi .sy3 {color: #000066;}
.delphi.source-delphi .st0 {color: #ff0000;}
.delphi.source-delphi .nu0 {color: #0000ff;}
.delphi.source-delphi .me1 {color: #006600;}
.delphi.source-delphi .re0 {color: #9ac;}
.delphi.source-delphi .re1 {color: #ff0000;}
.delphi.source-delphi .ln-xtra, .delphi.source-delphi li.ln-xtra, .delphi.source-delphi div.ln-xtra {background-color: #ffc;}
.delphi.source-delphi span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "https://frp.sage.fr/wiki1000/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Curseurs_d_objets_tech action-view skin-monobook">
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading">Curseurs d'objets (tech)</h1>
	<div id="bodyContent">
		<div id="siteSub">De Wiki1000</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav">Aller à : <a href="Curseurs_d'objets_(tech).html#column-one">Navigation</a>, <a href="Curseurs_d'objets_(tech).html#searchInput">rechercher</a></div>
		<!-- start content -->
<div lang="fr" dir="ltr" class="mw-content-ltr"><table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Sommaire</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Curseurs_d'objets_(tech).html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Curseurs_d'objets_(tech).html#D.C3.A9claration_d.27une_variable_curseur"><span class="tocnumber">2</span> <span class="toctext">Déclaration d'une variable curseur</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Curseurs_d'objets_(tech).html#Cr.C3.A9ation_d.27un_objet_curseur"><span class="tocnumber">3</span> <span class="toctext">Création d'un objet curseur</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="Curseurs_d'objets_(tech).html#Utilisation_du_ClassManager"><span class="tocnumber">3.1</span> <span class="toctext">Utilisation du ClassManager</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="Curseurs_d'objets_(tech).html#Utilisation_du_constructeur_de_curseur_d.27une_classe_m.C3.A9tier"><span class="tocnumber">3.2</span> <span class="toctext">Utilisation du constructeur de curseur d'une classe métier</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="Curseurs_d'objets_(tech).html#Propri.C3.A9t.C3.A9s"><span class="tocnumber">4</span> <span class="toctext">Propriétés</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="Curseurs_d'objets_(tech).html#Propri.C3.A9t.C3.A9s_de_param.C3.A9trage_du_curseur"><span class="tocnumber">4.1</span> <span class="toctext">Propriétés de paramétrage du curseur</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="Curseurs_d'objets_(tech).html#Propri.C3.A9t.C3.A9s_des_curseurs_avec_agr.C3.A9gats"><span class="tocnumber">4.2</span> <span class="toctext">Propriétés des curseurs avec agrégats</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="Curseurs_d'objets_(tech).html#Propri.C3.A9t.C3.A9s_d.27ex.C3.A9cution"><span class="tocnumber">4.3</span> <span class="toctext">Propriétés d'exécution</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="Curseurs_d'objets_(tech).html#M.C3.A9thodes"><span class="tocnumber">5</span> <span class="toctext">Méthodes</span></a></li>
</ul>
</td></tr></table>
<h3> <span class="mw-headline" id="Introduction">Introduction</span></h3>
<p>Les curseurs d'objets (TCursor) permettent d'accéder à un ou plusieurs objets d'une base de données en spécifiant des critères de recherche et de tri ou en utilisant directement des instructions SQL.
</p>
<div style="font-color:#535068; border:solid 1px #A8A8A8; padding:0.5em 1em 0.5em 0.7em; margin:0.5em 0em; background-color:#F9F9F9;font-size:100%;">
<table style="background-color:#F9F9F9;">
<tr>
<td><a href="Fichier%253AInfo-20px.png.html" class="image"><img alt="Info-20px.png" src="../images/b/b3/Info-20px.png" width="20" height="20" /></a>
</td>
<td><b>Note&#160;:</b> Les listes d'objets peuvent être utilisé comme attribut non persistant
</td></tr></table>
</div>
<p>Généralement l’utilisation d’un curseur suit le schéma suivant&#160;:
</p>
<ol><li>Le curseur est créé sur une classe particulière, ce sont les objets de cette classe qui seront retournés.
</li><li>Les critères de recherche et de tri sont définis.
</li><li>Le curseur est ouvert.
</li><li>Tant qu’il existe des objets dans le résultat, le curseur est parcouru&#160;; les objets sont retournés un par un dans cette boucle.
</li><li>Le curseur est fermé.
</li></ol>
<p>Les curseurs peuvent être implémentés de manière différente suivant les types de serveur de données&#160;; un certain nombre de règles doivent être respectées&#160;:
</p>
<ol><li>Les curseurs sont prévus pour retourner des objets&#160;; ne pas utiliser d’ordre de mise à jour dans le code SQL définissant un curseur.
</li><li>Lorsqu’un curseur est utilisé dans le cadre d’une transaction longue, il est nécessaire de créer la transaction longue avant le curseur.
</li></ol>
<h3> <span class="mw-headline" id="D.C3.A9claration_d.27une_variable_curseur">Déclaration d'une variable curseur</span></h3>
<p>Les curseurs doivent être déclarée avant d'être utilisées, lorsque la classe du curseur est connue au moment de la déclaration la forme préfixé du nom de la classe métier peut être utilisée&#160;:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="delphi source-delphi" style="font-family:monospace;"><pre class="de1"><span class="kw1">var</span> ls<span class="sy1">:</span>NomDeClassCursor<span class="sy1">;</span></pre></div></div>
<p>Cette forme de déclaration permet au compilateur de connaitre la classe des objets du curseur.
</p>
<h3> <span class="mw-headline" id="Cr.C3.A9ation_d.27un_objet_curseur">Création d'un objet curseur</span></h3>
<h4> <span class="mw-headline" id="Utilisation_du_ClassManager">Utilisation du ClassManager</span></h4>
<p>Le <a href="ClassManager_(code).html" title="ClassManager (code)">ClassManager</a> expose une fonction pour créer des curseurs d'une classe donnée&#160;:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="delphi source-delphi" style="font-family:monospace;"><pre class="de1"><span class="kw1">function</span> CreateCursor<span class="br0">&#40;</span><span class="kw1">const</span> iClassName <span class="sy1">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy1">:</span>TCursor<span class="sy1">;</span></pre></div></div>
<p>iClassName représente le nom de la classe des objets retournés par le curseur.
</p><p>Exemple 
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="delphi source-delphi" style="font-family:monospace;"><pre class="de1"><span class="kw1">var</span> ls<span class="sy1">:</span>TEcritureCursor<span class="sy1">;</span>
<span class="kw1">begin</span>
  ls <span class="sy1">:</span><span class="sy3">=</span> ClassManager<span class="sy1">.</span><span class="me1">CreateCursor</span><span class="br0">&#40;</span><span class="st0">'TEcriture'</span><span class="br0">&#41;</span><span class="sy1">;</span>
<span class="kw1">end</span><span class="sy1">;</span></pre></div></div>
<h4> <span class="mw-headline" id="Utilisation_du_constructeur_de_curseur_d.27une_classe_m.C3.A9tier">Utilisation du constructeur de curseur d'une classe métier</span></h4>
<p>Les <a href="https://frp.sage.fr/wiki1000/index.php/Classes_m%C3%83%C2%A9tiers_(tech)" title="Classes métiers (tech)">classes métiers</a> exposent un constructeur de curseur permettant de créer un curseur de la classe&#160;:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="delphi source-delphi" style="font-family:monospace;"><pre class="de1"><span class="kw1">class</span> <span class="kw1">function</span> TObjectClass<span class="sy1">.</span><span class="me1">CreateCursor</span><span class="sy1">:</span>TObjectClassCursor<span class="sy1">;</span></pre></div></div>
<p>Exemple 
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="delphi source-delphi" style="font-family:monospace;"><pre class="de1"><span class="kw1">var</span> ls<span class="sy1">:</span>TEcritureList<span class="sy1">;</span>
<span class="kw1">begin</span>
  ls <span class="sy1">:</span><span class="sy3">=</span> TEcriture<span class="sy1">.</span><span class="me1">CreateCursor</span><span class="sy1">;</span>
<span class="kw1">end</span><span class="sy1">;</span></pre></div></div>
<div style="font-color:#535068; border:solid 1px #A8A8A8; padding:0.5em 1em 0.5em 0.7em; margin:0.5em 0em; background-color:#F9F9F9;font-size:100%;">
<table style="background-color:#F9F9F9;">
<tr>
<td><a href="Fichier%253AInfo-20px.png.html" class="image"><img alt="Info-20px.png" src="../images/b/b3/Info-20px.png" width="20" height="20" /></a>
</td>
<td><b>Note&#160;:</b> Les deux formes de code sont équivalentes, la seconde est plus claire et évite les erreurs de frappe du nom des classes
</td></tr></table>
</div>
<h3> <span class="mw-headline" id="Propri.C3.A9t.C3.A9s">Propriétés</span></h3>
<h4> <span class="mw-headline" id="Propri.C3.A9t.C3.A9s_de_param.C3.A9trage_du_curseur">Propriétés de paramétrage du curseur</span></h4>
<table class="wikitable">

<tr>
<td><a href="ClassName_(cursor).html" title="ClassName (cursor)">ClassName</a>
</td>
<td>Nom de la classe sur laquelle porte le curseur.
</td></tr>
<tr>
<td><a href="Where_(cursor).html" title="Where (cursor)">Where</a>
</td>
<td>Critère de recherche objet permettant de sélectionner les enregistrements renvoyés.
</td></tr>
<tr>
<td><a href="ArgCount_(cursor).html" title="ArgCount (cursor)">ArgCount</a>
</td>
<td>Spécifie le nombre d'arguments utilisés dans WHERE.
</td></tr>
<tr>
<td><a href="Args_(cursor).html" title="Args (cursor)">Args</a>
</td>
<td>La propriété Args permet de consulter et de modifier dynamiquement la valeur des arguments utilisés dans WHERE.
</td></tr>
<tr>
<td><a href="OrderBy_(cursor).html" title="OrderBy (cursor)">OrderBy</a>
</td>
<td>Spécifie l'ordre de tri des enregistrements.
</td></tr>
<tr>
<td><a href="Descendants_(cursor).html" title="Descendants (cursor)">Descendants</a>
</td>
<td>Inclure ou non les objets descendants.
</td></tr>
<tr>
<td><a href="ClassFilter_(cursor).html" title="ClassFilter (cursor)">ClassFilter</a>
</td>
<td>Critère de recherche sur la classe des l'objets parcourus.
</td></tr>
<tr>
<td><a href="MaxInstances_(cursor).html" title="MaxInstances (cursor)">MaxInstances</a>
</td>
<td>Limite le nombre d'objet retourné.
</td></tr>
<tr>
<td><a href="NoLock_(cursor).html" title="NoLock (cursor)">NoLock</a>
</td>
<td>Utilise un Hint de base de données pour ne pas verrouiller la table SQL parcourue.
</td></tr>
<tr>
<td><a href="AnyWhere_(cursor).html" title="AnyWhere (cursor)">AnyWhere</a>
</td>
<td>Ne pas filter les objets sur les périmètres de partage.
</td></tr>
<tr>
<td><a href="SQL_(cursor).html" title="SQL (cursor)">SQL</a>
</td>
<td>La propriété SQL permet de définir directement les instructions SQL exécutées par le composant.
</td></tr>
<tr>
<td><a href="Translator_(cursor).html" title="Translator (cursor)">Translator</a>
</td>
<td>Objet technique permettant de formatter le code SQL en fonction du pilote de base de données
</td></tr></table>
<h4> <span class="mw-headline" id="Propri.C3.A9t.C3.A9s_des_curseurs_avec_agr.C3.A9gats">Propriétés des curseurs avec agrégats</span></h4>
<p>Les curseurs avec agrégats permettent d'exprimer sous forme objet l'équivalent d'un agrégat SQL.
</p><p>Lorsque des agrégats sont utilisés sur un curseur celui-ci ne peut pas retourner une instance d'objet et retourne des champs SQL.
</p><p>La numérotation des champs SQL est&#160;:
</p>
<ul><li> Les champs de regroupement.
</li><li> Les champs agrégés.
</li></ul>
<div style="font-color:#535068; border:solid 1px #A8A8A8; padding:0.5em 1em 0.5em 0.7em; margin:0.5em 0em; background-color:#F9F9F9;font-size:100%;">
<table style="background-color:#F9F9F9;">
<tr>
<td><a href="Fichier%253ATip-20px.png.html" class="image"><img alt="Tip-20px.png" src="../images/5/5e/Tip-20px.png" width="20" height="20" /></a>
</td>
<td><b>Tip&#160;:</b> L'utilisation de ces propriétés évitent d'écrire un curseur sous forme SQL.
</td></tr></table>
</div>
<table class="wikitable">

<tr>
<td><a href="AgregateCount_(cursor).html" title="AgregateCount (cursor)">AgregateCount</a>
</td>
<td>Détermine le nombre d'agrégat
</td></tr>
<tr>
<td><a href="Agregates_(cursor).html" title="Agregates (cursor)">Agregates</a>
</td>
<td>Détermine un attribut à agréger.
</td></tr>
<tr>
<td><a href="AgragateOpes_(cursor).html" title="AgragateOpes (cursor)">AgregateOpes</a>
</td>
<td>Détermine l'opérateur de l'agrégat.
</td></tr>
<tr>
<td><a href="GroupByCount_(cursor).html" title="GroupByCount (cursor)">GroupByCount</a>
</td>
<td>Détermine le nombre d'attribut à regrouper.
</td></tr>
<tr>
<td><a href="GroupBys_(cursor).html" title="GroupBys (cursor)">GroupBys</a>
</td>
<td>Détermine un attribut à regrouper.
</td></tr>
<tr>
<td><a href="FieldCount_(cursor).html" title="FieldCount (cursor)">FieldCount</a>
</td>
<td>Retourne le nombre de champs SQL de la requête.
</td></tr>
<tr>
<td><a href="Fields_(cursor).html" title="Fields (cursor)">Fields</a>
</td>
<td>Retourne la valeur courante du champ de la requête.
</td></tr></table>
<p>Exemple d'utilisation d'un curseur avec agrégats&#160;: 
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="delphi source-delphi" style="font-family:monospace;"><pre class="de1"><span class="co1">//Procedure TotalEngaementParNature(out rslt:WSX_NatureEngagementList);</span>
<span class="kw1">var</span> vCursor<span class="sy1">:</span>TDetailEngagementCursor<span class="sy1">;</span> inst<span class="sy1">:</span>WSX_NatureEngagement<span class="sy1">;</span>
<span class="kw1">begin</span>
  vCursor <span class="sy1">:</span><span class="sy3">=</span> TDetailEngagement<span class="sy1">.</span><span class="me1">CreateCursor</span><span class="sy1">;</span>
  vCursor<span class="sy1">.</span><span class="me1">Descendants</span> <span class="sy1">:</span><span class="sy3">=</span> <span class="kw2">True</span><span class="sy1">;</span>
  vCursor<span class="sy1">.</span><span class="me1">AgregateCount</span> <span class="sy1">:</span><span class="sy3">=</span> <span class="nu0">1</span><span class="sy1">;</span>
  vCursor<span class="sy1">.</span><span class="me1">Agregates</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">:</span><span class="sy3">=</span> <span class="st0">'montantValorisation'</span><span class="sy1">;</span>
  vCursor<span class="sy1">.</span><span class="me1">GroupBycount</span> <span class="sy1">:</span><span class="sy3">=</span> <span class="nu0">1</span><span class="sy1">;</span>
  vCursor<span class="sy1">.</span><span class="me1">GroupBys</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">:</span><span class="sy3">=</span> <span class="st0">'NatureBudgetaire.code'</span><span class="sy1">;</span>
  vCursor<span class="sy1">.</span><span class="me1">Open</span><span class="sy1">;</span>
  <span class="kw1">while</span> <span class="kw1">not</span> vCursor<span class="sy1">.</span><span class="me1">Eoi</span> <span class="kw1">do</span>
   <span class="kw1">begin</span>
     inst <span class="sy1">:</span><span class="sy3">=</span> WSE_NatureEngagement<span class="sy1">.</span><span class="me1">Create</span><span class="sy1">;</span>
     inst<span class="sy1">.</span><span class="me1">Code</span> <span class="sy1">:</span><span class="sy3">=</span> vCursor<span class="sy1">.</span><span class="me1">Fields</span><span class="br0">&#91;</span>0<span class="br0">&#93;</span><span class="sy1">;</span>
     inst<span class="sy1">.</span><span class="me1">Montant</span> <span class="sy1">:</span><span class="sy3">=</span> vCursor<span class="sy1">.</span><span class="me1">Fields</span><span class="br0">&#91;</span>1<span class="br0">&#93;</span><span class="sy1">;</span>
     rslt<span class="sy1">.</span><span class="me1">AddRef</span><span class="br0">&#40;</span>inst<span class="br0">&#41;</span><span class="sy1">;</span>
     vCursor<span class="sy1">.</span><span class="me1">Next</span><span class="sy1">;</span>
   <span class="kw1">end</span><span class="sy1">;</span>
<span class="kw1">end</span><span class="sy1">;</span></pre></div></div>
<div style="font-color:#535068; border:solid 1px #A8A8A8; padding:0.5em 1em 0.5em 0.7em; margin:0.5em 0em; background-color:#F9F9F9;font-size:100%;">
<table style="background-color:#F9F9F9;">
<tr>
<td><a href="Fichier%253ATip-20px.png.html" class="image"><img alt="Tip-20px.png" src="../images/5/5e/Tip-20px.png" width="20" height="20" /></a>
</td>
<td><b>Tip&#160;:</b> Une autre façon de réaliser un curseur sur des agrégats est d'utiliser un curseur sur une vue avec agrégats; cette manière est préférable car elle utilise un formalisme objet et pas SQL
</td></tr></table>
</div>
<h4> <span class="mw-headline" id="Propri.C3.A9t.C3.A9s_d.27ex.C3.A9cution">Propriétés d'exécution</span></h4>
<table class="wikitable">

<tr>
<td><a href="EOI_(cursor).html" title="EOI (cursor)">EOI</a>
</td>
<td>Indique si le curseur a atteint la fin de l'ensemble de données.
</td></tr>
<tr>
<td><a href="LOI_(cursor).html" title="LOI (cursor)">LOI</a>
</td>
<td>Indique si le curseur est positionné sur le dernier enregistrement d'un ensemble de données.<img src="../medias/images/stock/version650-32x32.png" alt="version650-32x32.png" />
</td></tr>
<tr>
<td><a href="Count_(cursor).html" title="Count (cursor)">Count</a>
</td>
<td>Renvoie le nombre d'objet qui sera parcourus par le curseur.
</td></tr>
<tr>
<td><a href="FETCHCOUNT_(cursor).html" title="FETCHCOUNT (cursor)">FetchCount</a>
</td>
<td>Renvoie le nombre de fetch réalisés.
</td></tr>
<tr>
<td><a href="OID_(cursor).html" title="OID (cursor)">OID</a>
</td>
<td>Renvoie l'identifiant de l'objet courant.
</td></tr>
<tr>
<td><a href="INSTANCE_(cursor).html" title="INSTANCE (cursor)">Instance</a>
</td>
<td>Renvoie l'instance d'objet courant. La classe de cette instance est la classe spécifiée à la création du curseur.
</td></tr></table>
<h3> <span class="mw-headline" id="M.C3.A9thodes">Méthodes</span></h3>
<table class="wikitable">

<tr>
<td><a href="Open_(cursor).html" title="Open (cursor)">Open</a>
</td>
<td>Exécute la requête.
</td></tr>
<tr>
<td><a href="Close_(cursor).html" title="Close (cursor)">Close</a>
</td>
<td>Ferme le curseur.
</td></tr>
<tr>
<td><a href="Rollback_(cursor).html" title="Rollback (cursor)">Rollback</a>
</td>
<td>Annule toutes les modifications, insertions ou suppressions de données de la transaction en cours et termine la transaction Valable pour un curseur de type modification.
</td></tr>
<tr>
<td><a href="Next_(cursor).html" title="Next (cursor)">Next</a>
</td>
<td>Appelez Next pour placer le curseur sur l'enregistrement suivant.
</td></tr></table>
<p><br />
</p>
<center>
<p>&#8212; <a href="https://frp.sage.fr/wiki1000/index.php/Code_m%C3%83%C2%A9tier" title="Code métier">Code métier</a>
&#8212; <a href="https://frp.sage.fr/wiki1000/index.php/D%C3%83%C2%A9veloppement_DSM" title="Développement DSM">Développement DSM</a> &#8212; 
</p>
</center>

<!-- 
NewPP limit report
Preprocessor node count: 140/1000000
Post-expand include size: 1837/2097152 bytes
Template argument size: 512/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key wiki1000dbtahoe-l1000_:pcache:idhash:262-0!*!0!!fr!2!* and timestamp 20240729130233 -->
<br /><br /><br /><br /><table class="whos_here" width="100%" cellpadding="0" cellspacing="0"><tr>
                        <td width="100%" class="whos_here_header">
                        <a href="Special%253AAWCforum/whoshere.html"><i>Whos here now:</i></a>  
                        &nbsp; <b>Members</b> 0
                        &nbsp; <b>Guests</b> 0
                        &nbsp; <b>Bots & Crawlers</b>  1
                        </td>
         </tr><tr><td class="whos_here_row"> &nbsp;   </td></tr></table></div><div class="printfooter">
Récupérée de « <a href="https://frp.sage.fr/wiki1000/index.php?title=Curseurs_d%27objets_(tech)&amp;oldid=11197">https://frp.sage.fr/wiki1000/index.php?title=Curseurs_d%27objets_(tech)&amp;oldid=11197</a> »</div>
		<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="https://frp.sage.fr/wiki1000/index.php/Sp%C3%83%C2%A9cial:Cat%C3%83%C2%A9gories" title="Spécial:Catégories">Catégories</a> : <ul><li><a href="https://frp.sage.fr/wiki1000/index.php/Cat%C3%83%C2%A9gorie:Objets_techniques" title="Catégorie:Objets techniques">Objets techniques</a></li><li><a href="https://frp.sage.fr/wiki1000/index.php/Cat%C3%83%C2%A9gorie:Objets_it%C3%83%C2%A9rateurs" title="Catégorie:Objets itérateurs">Objets itérateurs</a></li><li><a href="https://frp.sage.fr/wiki1000/index.php/Cat%C3%83%C2%A9gorie:Curseur" title="Catégorie:Curseur">Curseur</a></li></ul></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Affichages</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="Curseurs_d'objets_(tech).html" title="Voir la page de contenu [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="https://frp.sage.fr/wiki1000/index.php?title=Discussion:Curseurs_d'objets_(tech)&amp;action=edit&amp;redlink=1" title="Discussion au sujet de cette page de contenu [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="https://frp.sage.fr/wiki1000/index.php?title=Curseurs_d'objets_(tech)&amp;action=edit" title="Cette page est protégée.&#10;Vous pouvez toutefois en visualiser la source. [e]" accesskey="e">Voir le texte source</a></li>
				<li id="ca-history"><a href="https://frp.sage.fr/wiki1000/index.php?title=Curseurs_d'objets_(tech)&amp;action=history" title="Les versions passées de cette page (avec leurs contributeurs) [h]" accesskey="h">Historique</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Outils personnels</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="https://frp.sage.fr/wiki1000/index.php?title=Sp%C3%83%C2%A9cial:Connexion&amp;returnto=Curseurs+d'objets+(tech)" title="Vous êtes encouragé(e) à vous identifier ; ce n'est cependant pas obligatoire. [o]" accesskey="o">Connexion</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a title="Page principale" style="background-image: url(../medias/images/stock/wiki-1000.png);" href="Main_Page.html"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="Main_Page.html" title="Visiter la page d'accueil du site [z]" accesskey="z">Main Page</a></li>
				<li id="n-recentchanges"><a href="https://frp.sage.fr/wiki1000/index.php/Sp%C3%83%C2%A9cial:Modifications_r%C3%83%C2%A9centes" title="Liste des modifications récentes sur le wiki [r]" accesskey="r">Modifications récentes</a></li>
				<li id="n-help"><a href="https://frp.sage.fr/wiki1000/index.php/Aide:Accueil" title="Aide">Aide</a></li>
				<li id="n-Guide-de-r.C3.A9daction"><a href="https://frp.sage.fr/wiki1000/index.php/Guide_de_r%C3%83%C2%A9daction_(wiki)">Guide de rédaction</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-Th.C3.A8mes">
		<h5>Thèmes</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Administration"><a href="https://frp.sage.fr/wiki1000/index.php/Cat%C3%83%C2%A9gorie:Administration">Administration</a></li>
				<li id="n-D.C3.A9veloppement"><a href="https://frp.sage.fr/wiki1000/index.php/D%C3%83%C2%A9veloppement_DSM">Développement</a></li>
				<li id="n-Didactitiels"><a href="https://frp.sage.fr/wiki1000/index.php/Cat%C3%83%C2%A9gorie:Video">Didactitiels</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Rechercher</label></h5>
		<div id="searchBody" class="pBody">
			<form action="https://frp.sage.fr/wiki1000/index.php" id="searchform">
				<input type='hidden' name="title" value="Spécial:Recherche"/>
				<input type="search" name="search" title="Rechercher dans Wiki1000 [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Lire" title="Aller vers une page portant exactement ce nom si elle existe." id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Rechercher" title="Rechercher les pages comportant ce texte." id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Boîte à outils</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="https://frp.sage.fr/wiki1000/index.php/Sp%C3%83%C2%A9cial:Pages_li%C3%83%C2%A9es/Curseurs_d'objets_(tech)" title="Liste des pages liées à celle-ci [j]" accesskey="j">Pages liées</a></li>
				<li id="t-recentchangeslinked"><a href="https://frp.sage.fr/wiki1000/index.php/Sp%C3%83%C2%A9cial:Suivi_des_liens/Curseurs_d'objets_(tech)" title="Liste des modifications récentes des pages liées à celle-ci [k]" accesskey="k">Suivi des pages liées</a></li>
				<li id="t-specialpages"><a href="https://frp.sage.fr/wiki1000/index.php/Sp%C3%83%C2%A9cial:Pages_sp%C3%83%C2%A9ciales" title="Liste de toutes les pages spéciales [q]" accesskey="q">Pages spéciales</a></li>
				<li><a href="https://frp.sage.fr/wiki1000/index.php?title=Curseurs_d'objets_(tech)&amp;printable=yes" rel="alternate">Version imprimable</a></li>
				<li id="t-permalink"><a href="https://frp.sage.fr/wiki1000/index.php?title=Curseurs_d'objets_(tech)&amp;oldid=11197" title="Lien permanent vers cette version de la page">Adresse de cette version</a></li>
<li id="t-pdf"><a href="https://frp.sage.fr/wiki1000/index.php?title=Sp%C3%83%C2%A9cial:Pdfprint&amp;page=Curseurs_d'objets_(tech)">Imprimer en PDF</a></li>			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> Dernière modification de cette page le 1 décembre 2016 à 17:20.<br /></li>
		<li id="viewcount">Cette page a été consultée 9 965 fois.</li>
		<li id="privacy"><a href="https://frp.sage.fr/wiki1000/index.php/Wiki1000:Confidentialit%C3%83%C2%A9" title="Wiki1000:Confidentialité">Politique de confidentialité</a></li>
		<li id="about"><a href="https://frp.sage.fr/wiki1000/index.php/Wiki1000:%C3%83%E2%82%AC_propos" title="Wiki1000:À propos">À propos de Wiki1000</a></li>
		<li id="disclaimer"><a href="https://frp.sage.fr/wiki1000/index.php/Wiki1000:Avertissements_g%C3%83%C2%A9n%C3%83%C2%A9raux" title="Wiki1000:Avertissements généraux">Avertissements</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
	mw.loader.load(["mediawiki.user", "mediawiki.util", "mediawiki.page.ready", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
}
</script>
<style type="text/css">.poll_display_table {
 
border: 1px solid #aaa;
    
    padding: 1px;
 
} 
.poll_displayheader {
 
border-bottom: 1px dashed #aaa;
    padding: 4px;
    background-color: #DDDDDD;
    font-family:"Courier New", Courier, mono;
 
} 
.poll_display_row {
 
border-bottom: 1px solid #aaa;
    background-color: #f9f9f9;
    padding: 2px;
 
} 
.poll_display_vote_total {
 
border-top: 1px solid #aaa;
    padding: 4px;
    background-color: #DDDDDD;
    font-family:"Courier New", Courier, mono;
 
} 
.poll_display_vote_numbers_header {
 
border: 1px solid #aaa;
border-bottom: 0;
 
} 
.poll_display_vote_percent_header {
 
border-top: 1px solid #aaa;
    padding: 1px;
 
} 
.poll_display_vote_option_header {
 
border: 1px solid #aaa;
    border-bottom: 0;
    padding: 1px;
 
} 
.poll_display_vote_numbers {
 
border: 1px solid #aaa;
    border-bottom: 0;
    padding: 1px;
 
} 
.poll_display_vote_percent {
 
border-top: 1px solid #aaa;
    padding: 1px;
 
} 
.poll_display_vote_option {
 
border: 1px solid #aaa;
    border-bottom: 0;
    padding: 1px;
 
} 
.poll_percent_color_op10 {
 background-color: #7FFF00; 
} 
.poll_percent_color_op1 {
 background-color: #CD5555; 
} 
.poll_percent_color_op2 {
 background-color: #5CACEE; 
} 
.poll_percent_color_op3 {
 background-color: #FFCC11; 
} 
.poll_percent_color_op4 {
 background-color: #668014; 
} 
.poll_percent_color_op5 {
 background-color: #A0522D; 
} 
.poll_percent_color_op6 {
 background-color: #9F79EE; 
} 
.poll_percent_color_op7 {
 background-color: #EE00EE; 
} 
.poll_percent_color_op8 {
 background-color: #DC143C; 
} 
.poll_percent_color_op9 {
 background-color: #551011; 
} 
.whos_here_header {
 
border-bottom: 1px dashed #aaa;
            padding: 4px;
            font-family:"Courier New", Courier, mono;
 
} 
.whos_here_row {
 
border-bottom: 1px solid #aaa;
            background-color: #f9f9f9;
            padding: 2px;
 
} 
.whos_here {
 
border: 1px solid #aaa;
            border-bottom: 0;
 
} 
.pagejumps_PostOnForumPage {
 
border: 1px solid #aaa;
    margin-left: 3px;
    font-size: 100%;
    padding-left: 3px;
    padding-right: 3px;
    padding-bottom: 0px;
 
} 

 .nothing {font-size: 0%;
                                margin: .0em;
                                border: 0;
                                margin: 0;
                                padding: 0;
                                width: 0;}
</style>

<script src="../load.php@debug=false&amp;lang=fr&amp;modules=site&amp;only=scripts&amp;skin=monobook&amp;%252A"></script>
<script>if(window.mw){
	mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,
	"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"searchNs121707":true,"variant":"fr","language":"fr","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs100":false,"searchNs101":false,"searchNs102":false,"searchNs103":false,"searchNs104":false,"searchNs105":false,"searchNs106":false,"searchNs107":false,"searchNs108":false,"searchNs109":false,"searchNs110":false,"searchNs111":false});;mw.user.tokens.set({"editToken":"+\\","watchToken":false});;mw.loader.state({"user.options":"ready","user.tokens":"ready"});
	
	/* cache key: wiki1000dbtahoe-l1000_:resourceloader:filter:minify-js:4:2d7b56d44af11e7e6a0c631677f449b0 */
}
</script><!-- Served in 0.264 secs. --><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8aad4a5a5f0e9527',t:'MTcyMjI1ODAxMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html>